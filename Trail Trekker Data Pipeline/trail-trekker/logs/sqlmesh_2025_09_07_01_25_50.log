2025-09-07 01:25:50,697 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'trail_trekker.db'} (connection.py:489)
2025-09-07 01:25:50,961 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-09-07 01:25:50,983 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: trail_trekker.db (connection.py:479)
2025-09-07 01:25:58,339 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-09-07 01:25:58,350 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-07 01:25:58,352 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'trail_trekker.sqlmesh__sqlmesh_example' (evaluator.py:1355)
2025-09-07 01:25:58,352 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE SCHEMA IF NOT EXISTS "trail_trekker"."sqlmesh__sqlmesh_example" (base.py:2466)
2025-09-07 01:25:58,352 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'trail_trekker.sqlmesh__staging' (evaluator.py:1355)
2025-09-07 01:25:58,352 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE SCHEMA IF NOT EXISTS "trail_trekker"."sqlmesh__staging" (base.py:2466)
2025-09-07 01:25:58,352 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'trail_trekker.sqlmesh__raw' (evaluator.py:1355)
2025-09-07 01:25:58,353 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE SCHEMA IF NOT EXISTS "trail_trekker"."sqlmesh__raw" (base.py:2466)
2025-09-07 01:25:58,353 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-07 01:25:58,355 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema trail_trekker.sqlmesh__staging (evaluator.py:1458)
2025-09-07 01:25:58,355 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,356 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,356 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__subscriptions__2302840668', 'staging__customers__3616143390', 'staging__plans__3559592048', 'staging__features__2202684849') (base.py:2466)
2025-09-07 01:25:58,363 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"trail_trekker"."staging"."customers": 3864119035> (evaluator.py:701)
2025-09-07 01:25:58,364 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__customers__3616143390" (base.py:2466)
2025-09-07 01:25:58,364 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'trail_trekker.sqlmesh__staging.staging__customers__3616143390' (evaluator.py:2385)
2025-09-07 01:25:58,369 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE VIEW "trail_trekker"."sqlmesh__staging"."staging__customers__3616143390" AS SELECT "customers"."customer_id" AS "customer_id", "customers"."username" AS "username", "customers"."email" AS "email", "customers"."phone" AS "phone", "customers"."first_name" AS "first_name", "customers"."last_name" AS "last_name", CAST("customers"."date_of_birth" AS TIMESTAMP) AS "birth_date", "customers"."preferred_difficulty" AS "difficulty_preference", "customers"."location_city" AS "location_city", "customers"."location_state" AS "location_state", "customers"."location_country" AS "location_country", CAST("customers"."profile_created_date" AS TIMESTAMP) AS "profile_created_at", "customers"."total_hikes_logged" AS "total_hikes_logged", "customers"."favorite_trail_type" AS "favorite_trail_type" FROM "trail_trekker"."sqlmesh__raw"."raw__customers__3881866267" AS "customers" (base.py:2466)
2025-09-07 01:25:58,369 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"trail_trekker"."staging"."customers": 3864119035> (evaluator.py:905)
2025-09-07 01:25:58,372 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-06 00:00:00, 2025-09-07 00:00:00) into trail_trekker.sqlmesh__staging.staging__customers__3616143390' (evaluator.py:935)
2025-09-07 01:25:58,372 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__customers__3616143390" (base.py:2466)
2025-09-07 01:25:58,373 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'trail_trekker.sqlmesh__staging.staging__customers__3616143390' (evaluator.py:2349)
2025-09-07 01:25:58,373 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,373 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,374 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__customers__3616143390') (base.py:2466)
2025-09-07 01:25:58,376 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE OR REPLACE VIEW "trail_trekker"."sqlmesh__staging"."staging__customers__3616143390" ("customer_id", "username", "email", "phone", "first_name", "last_name", "birth_date", "difficulty_preference", "location_city", "location_state", "location_country", "profile_created_at", "total_hikes_logged", "favorite_trail_type") AS SELECT "customers"."customer_id" AS "customer_id", "customers"."username" AS "username", "customers"."email" AS "email", "customers"."phone" AS "phone", "customers"."first_name" AS "first_name", "customers"."last_name" AS "last_name", CAST("customers"."date_of_birth" AS TIMESTAMP) AS "birth_date", "customers"."preferred_difficulty" AS "difficulty_preference", "customers"."location_city" AS "location_city", "customers"."location_state" AS "location_state", "customers"."location_country" AS "location_country", CAST("customers"."profile_created_date" AS TIMESTAMP) AS "profile_created_at", "customers"."total_hikes_logged" AS "total_hikes_logged", "customers"."favorite_trail_type" AS "favorite_trail_type" FROM "trail_trekker"."sqlmesh__raw"."raw__customers__3881866267" AS "customers" (base.py:2466)
2025-09-07 01:25:58,376 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"trail_trekker"."staging"."customers": 3864119035> (evaluator.py:593)
2025-09-07 01:25:58,377 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__customers__3616143390" (base.py:2466)
2025-09-07 01:25:58,381 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__staging"."staging__customers__3616143390" AS "staging__customers__3616143390" WHERE ("customer_id" IS NULL OR "username" IS NULL OR "email" IS NULL) AND TRUE) AS "audit" (base.py:2466)
2025-09-07 01:25:58,381 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-06 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"trail_trekker"."staging"."customers": 3864119035> (facade.py:617)
2025-09-07 01:25:58,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"trail_trekker"."staging"."customers": 3864119035> (interval.py:214)
2025-09-07 01:25:58,386 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"trail_trekker"."staging"."features": 2100536223> (evaluator.py:701)
2025-09-07 01:25:58,386 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__features__2202684849" (base.py:2466)
2025-09-07 01:25:58,386 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'trail_trekker.sqlmesh__staging.staging__features__2202684849' (evaluator.py:2385)
2025-09-07 01:25:58,388 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE VIEW "trail_trekker"."sqlmesh__staging"."staging__features__2202684849" AS SELECT "features"."feature_id" AS "feature_id", "features"."feature_name" AS "feature_name", "features"."feature_description" AS "feature_description", "features"."feature_category" AS "feature_category" FROM "trail_trekker"."sqlmesh__raw"."raw__features__2713381237" AS "features" (base.py:2466)
2025-09-07 01:25:58,389 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"trail_trekker"."staging"."features": 2100536223> (evaluator.py:905)
2025-09-07 01:25:58,390 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-06 00:00:00, 2025-09-07 00:00:00) into trail_trekker.sqlmesh__staging.staging__features__2202684849' (evaluator.py:935)
2025-09-07 01:25:58,390 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__features__2202684849" (base.py:2466)
2025-09-07 01:25:58,390 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'trail_trekker.sqlmesh__staging.staging__features__2202684849' (evaluator.py:2349)
2025-09-07 01:25:58,391 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,391 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,391 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__features__2202684849') (base.py:2466)
2025-09-07 01:25:58,393 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE OR REPLACE VIEW "trail_trekker"."sqlmesh__staging"."staging__features__2202684849" ("feature_id", "feature_name", "feature_description", "feature_category") AS SELECT "features"."feature_id" AS "feature_id", "features"."feature_name" AS "feature_name", "features"."feature_description" AS "feature_description", "features"."feature_category" AS "feature_category" FROM "trail_trekker"."sqlmesh__raw"."raw__features__2713381237" AS "features" (base.py:2466)
2025-09-07 01:25:58,393 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"trail_trekker"."staging"."features": 2100536223> (evaluator.py:593)
2025-09-07 01:25:58,393 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__features__2202684849" (base.py:2466)
2025-09-07 01:25:58,395 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__staging"."staging__features__2202684849" AS "staging__features__2202684849" WHERE "feature_id" IS NULL AND TRUE) AS "audit" (base.py:2466)
2025-09-07 01:25:58,395 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-06 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"trail_trekker"."staging"."features": 2100536223> (facade.py:617)
2025-09-07 01:25:58,396 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"trail_trekker"."staging"."features": 2100536223> (interval.py:214)
2025-09-07 01:25:58,399 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"trail_trekker"."staging"."plans": 1690486567> (evaluator.py:701)
2025-09-07 01:25:58,399 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__plans__3559592048" (base.py:2466)
2025-09-07 01:25:58,399 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'trail_trekker.sqlmesh__staging.staging__plans__3559592048' (evaluator.py:2385)
2025-09-07 01:25:58,402 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE VIEW "trail_trekker"."sqlmesh__staging"."staging__plans__3559592048" AS SELECT "plans"."plan_id" AS "plan_id", "plans"."plan_name" AS "plan_name", "plans"."plan_level" AS "plan_level", "plans"."price" AS "monthly_price_usd", "plans"."max_hikes_per_month" AS "max_hikes_per_month", "plans"."photo_storage_gb" AS "photo_storage_gb", "plans"."description" AS "plan_description", CAST("plans"."created_at" AS TIMESTAMP) AS "plan_created_at" FROM "trail_trekker"."sqlmesh__raw"."raw__plans__3729495492" AS "plans" (base.py:2466)
2025-09-07 01:25:58,402 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"trail_trekker"."staging"."plans": 1690486567> (evaluator.py:905)
2025-09-07 01:25:58,405 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-06 00:00:00, 2025-09-07 00:00:00) into trail_trekker.sqlmesh__staging.staging__plans__3559592048' (evaluator.py:935)
2025-09-07 01:25:58,405 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__plans__3559592048" (base.py:2466)
2025-09-07 01:25:58,405 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'trail_trekker.sqlmesh__staging.staging__plans__3559592048' (evaluator.py:2349)
2025-09-07 01:25:58,405 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,406 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,406 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__plans__3559592048') (base.py:2466)
2025-09-07 01:25:58,408 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE OR REPLACE VIEW "trail_trekker"."sqlmesh__staging"."staging__plans__3559592048" ("plan_id", "plan_name", "plan_level", "monthly_price_usd", "max_hikes_per_month", "photo_storage_gb", "plan_description", "plan_created_at") AS SELECT "plans"."plan_id" AS "plan_id", "plans"."plan_name" AS "plan_name", "plans"."plan_level" AS "plan_level", "plans"."price" AS "monthly_price_usd", "plans"."max_hikes_per_month" AS "max_hikes_per_month", "plans"."photo_storage_gb" AS "photo_storage_gb", "plans"."description" AS "plan_description", CAST("plans"."created_at" AS TIMESTAMP) AS "plan_created_at" FROM "trail_trekker"."sqlmesh__raw"."raw__plans__3729495492" AS "plans" (base.py:2466)
2025-09-07 01:25:58,408 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"trail_trekker"."staging"."plans": 1690486567> (evaluator.py:593)
2025-09-07 01:25:58,408 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__plans__3559592048" (base.py:2466)
2025-09-07 01:25:58,411 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__staging"."staging__plans__3559592048" AS "staging__plans__3559592048" WHERE ("plan_id" IS NULL OR "plan_name" IS NULL OR "plan_level" IS NULL) AND TRUE) AS "audit" (base.py:2466)
2025-09-07 01:25:58,412 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"trail_trekker"."staging"."subscriptions": 1488342148> (evaluator.py:701)
2025-09-07 01:25:58,412 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__subscriptions__2302840668" (base.py:2466)
2025-09-07 01:25:58,413 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'trail_trekker.sqlmesh__staging.staging__subscriptions__2302840668' (evaluator.py:2385)
2025-09-07 01:25:58,416 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE VIEW "trail_trekker"."sqlmesh__staging"."staging__subscriptions__2302840668" AS SELECT "subscriptions"."subscription_id" AS "subscription_id", "subscriptions"."customer_id" AS "customer_id", "subscriptions"."plan_id" AS "plan_id", "subscriptions"."billing_cycle" AS "billing_cadence", CAST("subscriptions"."subscription_start_date" AS TIMESTAMP) AS "subscription_started_at", CAST("subscriptions"."subscription_end_date" AS TIMESTAMP) AS "subscription_ended_at", "subscriptions"."status" AS "subscription_status", CAST("subscriptions"."next_billing_date" AS TIMESTAMP) AS "next_billing_at", "subscriptions"."payment_method" AS "payment_method" FROM "trail_trekker"."sqlmesh__raw"."raw__subscriptions__1429161402" AS "subscriptions" (base.py:2466)
2025-09-07 01:25:58,416 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"trail_trekker"."staging"."subscriptions": 1488342148> (evaluator.py:905)
2025-09-07 01:25:58,418 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-06 00:00:00, 2025-09-07 00:00:00) into trail_trekker.sqlmesh__staging.staging__subscriptions__2302840668' (evaluator.py:935)
2025-09-07 01:25:58,418 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__subscriptions__2302840668" (base.py:2466)
2025-09-07 01:25:58,419 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'trail_trekker.sqlmesh__staging.staging__subscriptions__2302840668' (evaluator.py:2349)
2025-09-07 01:25:58,419 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,419 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT CURRENT_CATALOG() (base.py:2466)
2025-09-07 01:25:58,419 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__staging') AND table_name IN ('staging__subscriptions__2302840668') (base.py:2466)
2025-09-07 01:25:58,421 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ CREATE OR REPLACE VIEW "trail_trekker"."sqlmesh__staging"."staging__subscriptions__2302840668" ("subscription_id", "customer_id", "plan_id", "billing_cadence", "subscription_started_at", "subscription_ended_at", "subscription_status", "next_billing_at", "payment_method") AS SELECT "subscriptions"."subscription_id" AS "subscription_id", "subscriptions"."customer_id" AS "customer_id", "subscriptions"."plan_id" AS "plan_id", "subscriptions"."billing_cycle" AS "billing_cadence", CAST("subscriptions"."subscription_start_date" AS TIMESTAMP) AS "subscription_started_at", CAST("subscriptions"."subscription_end_date" AS TIMESTAMP) AS "subscription_ended_at", "subscriptions"."status" AS "subscription_status", CAST("subscriptions"."next_billing_date" AS TIMESTAMP) AS "next_billing_at", "subscriptions"."payment_method" AS "payment_method" FROM "trail_trekker"."sqlmesh__raw"."raw__subscriptions__1429161402" AS "subscriptions" (base.py:2466)
2025-09-07 01:25:58,421 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"trail_trekker"."staging"."subscriptions": 1488342148> (evaluator.py:593)
2025-09-07 01:25:58,422 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ DESCRIBE "trail_trekker"."sqlmesh__staging"."staging__subscriptions__2302840668" (base.py:2466)
2025-09-07 01:25:58,424 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1d8e30bcf852435f8b52dd3d01ec9347 */ SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__staging"."staging__subscriptions__2302840668" AS "staging__subscriptions__2302840668" WHERE ("subscription_id" IS NULL OR "customer_id" IS NULL OR "plan_id" IS NULL) AND TRUE) AS "audit" (base.py:2466)
2025-09-07 01:25:58,424 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-06 00:00:00, 2025-09-07 00:00:00) for snapshot SnapshotId<"trail_trekker"."staging"."subscriptions": 1488342148> (facade.py:617)
2025-09-07 01:25:58,424 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"trail_trekker"."staging"."subscriptions": 1488342148> (interval.py:214)
2025-09-07 01:25:58,428 - MainThread - sqlmesh.core.scheduler - INFO - Execution failed for node EvaluateNode(snapshot_name='"trail_trekker"."staging"."plans"', interval=(1757116800000, 1757203200000), batch_index=0) (scheduler.py:588)
Traceback (most recent call last):
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/utils/concurrency.py", line 234, in sequential_apply_to_dag
    fn(node)
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/scheduler.py", line 525, in run_node
    audit_results = self.evaluate(
                    ^^^^^^^^^^^^^^
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/scheduler.py", line 242, in evaluate
    audit_results = self._audit_snapshot(
                    ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/scheduler.py", line 862, in _audit_snapshot
    raise NodeAuditsErrors(audit_errors_to_raise)
sqlmesh.utils.errors.NodeAuditsErrors: Audits failed: not_null

The above exception was the direct cause of the following exception:

sqlmesh.utils.concurrency.NodeExecutionFailedError: Execution failed for node EvaluateNode(snapshot_name='"trail_trekker"."staging"."plans"', interval=(1757116800000, 1757203200000), batch_index=0)
2025-09-07 01:25:58,430 - MainThread - sqlmesh.core.context - INFO - Plan application failed. (context.py:1729)
Traceback (most recent call last):
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/context.py", line 1721, in apply
    self._apply(plan, circuit_breaker)
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/context.py", line 2514, in _apply
    self._scheduler.create_plan_evaluator(self).evaluate(
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/plan/evaluator.py", line 107, in evaluate
    self._evaluate_stages(plan_stages, plan)
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/plan/evaluator.py", line 127, in _evaluate_stages
    handler(stage, plan)
  File "/Users/atishdhamala/Trail Trekker Data Pipeline/.venv/lib/python3.11/site-packages/sqlmesh/core/plan/evaluator.py", line 262, in visit_backfill_stage
    raise PlanError("Plan application failed.")
sqlmesh.utils.errors.PlanError: Plan application failed.
2025-09-07 01:25:58,438 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
